!function(a){"function"==typeof define&&define.amd?define(["jquery","jquery-ui"],a):a(jQuery)}(function(a){"use strict";var b={},c=window;return b.config={rootPath:"XUtil"},b.helpers={log:function(){var a=Array.prototype.slice.apply(arguments,[]);a.unshift("(XUtil) "),console.log.apply(console,a)},error:function(){if(arguments[0]){var a="(XUtil) "+arguments[0].toString();return new Error(a)}},shimConsole:function(){var a=function(){};window.console||(window.console={log:a,error:a,warn:a})},addShield:function(b,c,d){var e,f,g,h,i,j=d||1e4;return!b&&(b=document.body),b=a(b),e=b.offset().top,f=b.offset().left,g=b.outerWidth(),h=b.outerHeight(),b[0]===document.body&&(g="100%",h="100%"),a.isNumeric(c)||(c=.3),i=a("<div class='XUtil-pageShield'></div>"),i.css("position","absolute").css("z-index",j).css("background","#000").css("opacity",c).css("top",e).css("left",f).css("width",g).css("height",h).appendTo(document.body),i},removeShield:function(b){b?a(".XUtil-pageShield").remove():a(b).remove()},showErrorHint:function(b,c,d){var e=a(b.parentNode),f=a("<span class='errorHint'>* "+c+"</span>");return 0===e.find(".errorHint").length&&f.insertAfter(b),d&&f.addClass(d),f},clearErrorHint:function(b){b?a(a(b).parent()).find(".errorHint").remove():a(".errorHint").remove()},getUrlArgs:function(){var a,b,c,d,e={},f=window.location||f,g=f.search.substring(1),h=g.split("&");for(a=0;a<h.length;a++)b=h[a].indexOf("="),-1!==b&&(c=h[a].substring(0,b),d=decodeURI(h[a].substring(b+1)),e[c]=d);return e},toQuery:function(a){var b="?";for(var c in a)a.hasOwnProperty(c)&&(b+=c+"="+a[c]+"&");return b},getUrl:function(a,b){var c=helpers;return encodeURI(a+c.toQuery(b))},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:0&b&3|8;return c.toString(16)}).toUpperCase()},preloadImages:function(){var a;for(a=0;a<arguments.length;a++)(new Image).src=arguments[a].toString()},safeEvent:function(b,c,d,e){var f,g,h=!1;c=c||window,d=d||300;var i=function(a){f=a,b.apply(c,g)};return function(){var b,c=a.now();g=Array.prototype.slice.apply(arguments),h?c-f>d&&i(c):(h=!0,i(c),e&&(b=setInterval(function(){var c=a.now();c-f>=e&&(i(c),clearInterval(b),h=!1)},d/10)))}},loadImg:function(b,c){var d,e=-1!==navigator.userAgent.search("MSIE 6.0"),f=-1!==navigator.userAgent.search("MSIE 7.0"),g=b.getAttribute("real-src"),h=1===parseInt(b.getAttribute("loaded"),10);b.getAttribute("img-index");(!h||e||f)&&(d=a(new Image),d.on("load",function(){a(b).attr({src:g,loaded:1}),c&&c(),d.remove()}).attr("src",g))}},b.helpers.shimConsole(),b.gallery=function(c){var d,e=a(c.renderTo),f=c.images||[],g=c.loadingImg||"http://www.51pptmoban.com/d/file/2013/01/15/e5b91925a8b2f56d69ec4c0cb492d5c1.jpg",h=c.initialIndex||0,i=c.width||1e3,j=c.height||600,k=c.animation||{type:"default",duration:0},l=a.isFunction(c.onclick)?c.onclick:function(a,b,c){window.console&&console.log("img "+a+" clicked."),window.console&&console.log(b)},m=parseInt(c.auto,10)||0,n=0;if("string"==typeof k?(d=k,n=400):(d=k.type||"default",n=k.duration||400),!e.eq(0))throw new Error("gallery组件: renderTo属性不能为空!");var o,p,q,r,s,t,u=a("<div class='pic_gallery'><ul class='gal_ctrl_list'></ul><div class='img_container'></div><a href='javascript:void 0;' class='prev'><div class='icon-left_arrow'></div></a><a href='javascript:void 0' class='next'><div class='icon-right_arrow'></div></a><div class='pg_text_box'><h3 class='pg_img_title'></h3><p class='pg_img_text'></p></div></div>"),v=u.find(".img_container"),w=u.find(".gal_ctrl_list"),x=u.find(".prev"),y=u.find(".next"),z=u.find(".pg_img_title"),A=u.find(".pg_img_text"),B=u.find(".pg_text_box"),C="icon-li_active",D="icon-li_hover",E=j/2-33,F=function(b,c){var d=a("<li>",{"class":"ctrl_li icon-li","li-index":c}).appendTo(w);a(b).attr("img-index",c).attr("loaded",0).prop("src",g).css({width:i,height:j}).appendTo(v),p.push(d[0])},G=b.helpers.loadImg,H=b.helpers.safeEvent,I=function(){clearInterval(t),t=setInterval(function(){N()},m)},J=function(){m&&(clearInterval(t),setTimeout(function(){I()},m))},K={"default":{turn:function(b){a(o).hide(),b.show()}},fade:{turn:function(b,c){a(o).hide(),c?b.show():b.fadeIn(n)}},slide:{init:function(){var b=a(o[s-1]).clone(!0,!0)[0],c=a(o[0]).clone(!0,!0)[0];o.before=b,o.after=c,G(b),G(c),a(v).prepend(b).append(c).css({width:i*(s+2),height:j,position:"absolute",left:0}),a(v).find("img").css({"float":"left"})},turn:function(a,b,c){var d,e=b&&q===s-1&&0===r,f=b&&0===q&&r===s-1,g=-i*(r+1);d=e?-i*(s+1):f?0:g,v.animate({left:d},c?0:n).promise().done(function(){(e||f)&&v.css("left",g)})}}},L=function(b,c,e){if(r=parseInt(b,10),r>=0&&s-1>=r){var f=a(o[r]),g=a(p[r]),h=f.attr("title"),i=f.attr("text"),j=K[d].turn;r-1>=0&&G(o[r-1]),s-1>=r+1&&G(o[r+1]),a(p).removeClass(C),g.addClass(C),z.text(h),A.text(i),B.attr("img_index",r),G(o[r]),j(f,c,e)}},M=function(){var a=0===r;q=r,a?L(s-1,!0):L(--r,!0)},N=function(){var a=r===s-1;q=r,a?L(0,!0):L(++r,!0)},O=function(){var b=K[d].init||a.noop;if(o=[],p=[],0===f.length)o=e.find("img").toArray();else for(var c=0;c<f.length;c++){var g=f[c],k=g.title||"",q=g.text||"",t=g.link,v=g.data||{},z=a("img",{link:t,title:k,text:q}).data("img-data",v).eq(0);o.push(z)}s=o.length,a.each(o,function(a){F(this,a)}),x.css({position:"absolute",top:E,display:"block",left:0}),y.css({position:"absolute",top:E,display:"block",right:0}),u.css({width:i,height:j,position:"relative",overflow:"hidden"}),function(){var b=H(function(){N()},window,n),c=H(function(){M()},window,n);w.off("mouseenter","li").off("mouseout","li").on("mouseenter","li",function(){a(this).addClass(D)}).on("mouseleave","li",function(){a(this).removeClass(D)}),w.off("click","li").on("click","li",function(){var a=this.getAttribute("li-index");J(),L(a,!1)}),x.off("click").on("click",function(){J(),c()}),y.off("click").on("click",function(){J(),b()}),a.merge(a(o),a(B)).off("click.pic_gal").on("click",function(){var b=this,c=o[r],d=a(c).data();l.apply(b,[r,c,d])})}(),G(o[h],function(){b(),e.empty().append(u),L(h,!1,!0),m&&I()})};return O(),{init:O,toImage:L,toPrev:M,toNext:N}},c.XUtil=b,c.myUtil=b,b});